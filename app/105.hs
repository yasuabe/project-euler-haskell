import Data.String.Utils
import Data.List

e105 ns = len == len' && (last ns < ns!!0 + ns!!1)
    where sums   = map sum$subsequences ns
          len    = length sums
          len'   = length$nub$sums
e105' ns = e105'' (div (length ns) 2)
    where e105'' 2   = last ns < ns!!0+ns!!1
          e105'' len = sum right < sum left && e105'' (len-1)
               where left = take len ns; right = reverse$take (len-1)$reverse ns
main = do cnt<-readFile "files/sets.txt"
--          mapM_ (\x->print (x,sum x))$filter e105$map toList $lines cnt
          mapM_ print$map (\x->(x, sum x))$filter e105'$filter e105$map toList $lines cnt
--          mapM_ print$map snd$filter e105'$filter e105$map toList $lines cnt
    where toList s = sort$map (read::String->Int)$split "," s
--73702
--[[298,2998,3178,6949],[1523,2873,2998,6029]]
--
tl = [[79,119,139,150,157,158,159,161,164],
  [180,270,324,350,354,359,360,362,370,384],
  [41,61,74,81,82,83,85,88],
  [25,40,41,42,44,48,55],
  [46,77,81,83,84,85,93,108],
  [173,281,292,300,302,303,304,308,346,389],
  [342,521,646,664,672,682,686,687,692,698,760],
  [175,262,330,337,340,343,344,356,361,382],
  [79,118,139,150,157,158,159,161,164],
  [76,96,127,135,136,138,141,154],
  [84,131,162,166,167,168,170,178,193],
  [343,518,606,652,673,683,686,687,694,701,706],
  [159,263,279,293,295,296,297,301,323,367],
  [29,36,40,41,42,44,59],
  [297,445,558,580,591,593,594,595,602,610,662],
  [174,265,310,331,338,343,344,352,355,366],
  [92,146,166,175,183,184,186,189,202],
  [31,50,54,58,61,64,66],
  [49,82,86,87,88,90,98,115],
  [20,40,47,48,49,51,54],
  [591,887,1035,1115,1167,1175,1182,1183,1184,1186,1197,1219],
  [140,218,238,271,279,280,282,285,298],
  [84,130,161,165,167,168,169,177,192],
  [90,142,174,177,179,180,184,191,206],
  [340,517,644,667,679,681,686,687,691,695,770],
  [296,444,524,576,584,591,592,593,595,606,628],
  [149,260,280,291,298,299,300,302,305,370],
  [54,75,85,95,96,97,102,109],
  [34,37,39,40,41,48,59]]

f ::[Int]->Int->[[Int]]
f _         0 = [[]]
f x@(xh:xt) n = [(h:t)|h<-x, t<-f xt (n-1)]

g l s x = [(l',s')|l'<-f x l, s' <- f (x\\l') s]
